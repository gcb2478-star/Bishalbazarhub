<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Snake ‚Äî AI Food Placement</title>
<style>
  :root { --bg: #0f1724; --panel: #0b1220; --accent: #10b981; --muted: #94a3b8; --danger: #ef4444; }
  body {
    background: linear-gradient(180deg,#071025 0%, #071a2a 100%);
    color: #e6eef8;
    font-family: Inter, system-ui, sans-serif;
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    margin:0;
    padding:20px;
  }
  .card {
    background: rgba(255,255,255,0.03);
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(2,6,23,0.6);
    padding: 18px;
    width: 460px;
  }
  header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
  header h1 { font-size:18px; margin:0; }
  .meta { font-size:12px; color:var(--muted); }
  canvas { background: #02111b; display:block; border-radius:8px; margin: 10px 0; width:100%; height:auto; }
  .row { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:6px; }
  .pill { background: rgba(255,255,255,0.05); padding:6px 10px; border-radius:999px; font-size:13px; }
  button, select {
    background: rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.08);
    color: #e6eef8;
    padding:6px 10px;
    border-radius:6px;
    cursor:pointer;
    font-size:13px;
  }
  .controls { display:flex; gap:6px; flex-wrap:wrap; }
  .message { margin-top:8px; font-size:14px; text-align:center; }
  .danger { color:var(--danger); }
  .note { font-size:12px; color:var(--muted); margin-top:6px; }
  .mobile-controls { display:flex; justify-content:center; margin-top:8px; gap:8px; }
  .mobile-btn {
    width:50px; height:50px;
    background:rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.08);
    border-radius:8px;
    font-size:18px; color:#e6eef8;
  }
  .chat-link { text-align:center; margin-top:12px; }
  .chat-link a {
    color: var(--accent);
    text-decoration: none;
    font-weight: bold;
  }
  @media(max-width:520px){ .card{ width:100%; } }
</style>
</head>
<body>
  <div class="card">
    <header>
      <h1>Snake ‚Äî AI Food</h1>
      <div class="meta">Reach the target score to win üéØ</div>
    </header>

    <canvas id="c" width="400" height="400"></canvas>

    <div class="row">
      <div class="pill">Score: <span id="score">0</span></div>
      <div class="pill">Target: <span id="target">10</span></div>
      <div class="pill">Speed: <span id="speedLabel">8</span> fps</div>
    </div>

    <div class="row" style="margin-top:6px;">
      <select id="difficulty">
        <option value="far">AI: Farthest Food (Hard)</option>
        <option value="near">AI: Nearest Food (Easy)</option>
      </select>
      <label>
        <input type="checkbox" id="wrapWalls"> Wrap Walls üåç
      </label>
      <div class="controls">
        <button id="pauseBtn">Pause</button>
        <button id="restartBtn">Restart</button>
      </div>
    </div>

    <div id="status" class="message"></div>
    <div id="aiNote" class="note"></div>

    <div class="mobile-controls">
      <button class="mobile-btn" onclick="setDir(0,-1)">‚Üë</button>
    </div>
    <div class="mobile-controls">
      <button class="mobile-btn" onclick="setDir(-1,0)">‚Üê</button>
      <button class="mobile-btn" onclick="setDir(1,0)">‚Üí</button>
    </div>
    <div class="mobile-controls">
      <button class="mobile-btn" onclick="setDir(0,1)">‚Üì</button>
    </div>

    <!-- üîó ChatGPT Chat History Link -->
    <div class="chat-link">
      <p>üìñ AI Chat History:</p>
      <a href="https://chatgpt.com/share/68ca4b6a-63fc-8006-ab11-ee13d0570cba" target="_blank">
        View Conversation
      </a>
    </div>
  </div>

<script>
(() => {
  const GRID=20,SIZE=400,CELL=SIZE/GRID;
  const INITIAL_SPEED=8,TARGET_SCORE=10;
  let snake,dir,nextDir,food,score,speed,loop,running,gameOver;

  const canvas=document.getElementById('c'),ctx=canvas.getContext('2d');
  const scoreEl=document.getElementById('score'),targetEl=document.getElementById('target');
  const speedLabel=document.getElementById('speedLabel'),status=document.getElementById('status');
  const aiNote=document.getElementById('aiNote'),pauseBtn=document.getElementById('pauseBtn');
  const restartBtn=document.getElementById('restartBtn'),diffSel=document.getElementById('difficulty');
  const wrapWalls=document.getElementById('wrapWalls');
  targetEl.textContent=TARGET_SCORE;

  function init(){
    const mid=Math.floor(GRID/2);
    snake=[{x:mid-1,y:mid},{x:mid,y:mid},{x:mid+1,y:mid}];
    dir={x:1,y:0};nextDir={x:1,y:0};score=0;speed=INITIAL_SPEED;
    running=true;gameOver=false;status.textContent='';aiNote.textContent='';
    placeFood();restartLoop();render();
  }
  function render(){
    ctx.fillStyle="#02111b";ctx.fillRect(0,0,SIZE,SIZE);
    if(food){ctx.fillStyle="#ef4444";ctx.fillRect(food.x*CELL+2,food.y*CELL+2,CELL-4,CELL-4);}
    snake.forEach((s,i)=>{ctx.fillStyle=i?"#0ea5a4":"#10b981";ctx.fillRect(s.x*CELL+1,s.y*CELL+1,CELL-2,CELL-2);});
    scoreEl.textContent=score;speedLabel.textContent=speed;
  }
  function tick(){
    if(!running||gameOver)return;
    if(nextDir.x!==-dir.x||nextDir.y!==-dir.y)dir=nextDir;
    let newHead={x:snake[0].x+dir.x,y:snake[0].y+dir.y};
    if(wrapWalls.checked){newHead.x=(newHead.x+GRID)%GRID;newHead.y=(newHead.y+GRID)%GRID;}
    if(!wrapWalls.checked&&(newHead.x<0||newHead.x>=GRID||newHead.y<0||newHead.y>=GRID))return end(false,"Crashed into wall!");
    if(snake.some(s=>s.x===newHead.x&&s.y===newHead.y))return end(false,"Bit yourself!");
    snake.unshift(newHead);
    if(food&&newHead.x===food.x&&newHead.y===food.y){
      score++;
      if(score>=TARGET_SCORE)return end(true,"You Win! üéâ");
      placeFood();if(score%3===0){speed=Math.min(18,speed+1);restartLoop();}
    }else snake.pop();
    render();
  }
  function end(win,msg){gameOver=true;running=false;clearInterval(loop);status.textContent=msg;status.className=win?'message':'message danger';}
  function restartLoop(){clearInterval(loop);loop=setInterval(tick,1000/speed);}
  window.addEventListener("keydown",e=>{
    if(e.key==="ArrowUp"||e.key==="w")nextDir={x:0,y:-1};
    if(e.key==="ArrowDown"||e.key==="s")nextDir={x:0,y:1};
    if(e.key==="ArrowLeft"||e.key==="a")nextDir={x:-1,y:0};
    if(e.key==="ArrowRight"||e.key==="d")nextDir={x:1,y:0};
    if(e.key==="p")togglePause();
  });
  function togglePause(){if(gameOver)return;running=!running;pauseBtn.textContent=running?"Pause":"Resume";}
  pauseBtn.onclick=togglePause;restartBtn.onclick=init;

  function placeFood(){
    const occupied=new Set(snake.map(p=>p.x+","+p.y));
    let empties=[];for(let x=0;x<GRID;x++)for(let y=0;y<GRID;y++)if(!occupied.has(x+","+y))empties.push({x,y});
    if(!empties.length)return;
    const head=snake[0];let dist=Array.from({length:GRID},()=>Array(GRID).fill(-1));
    let q=[head];dist[head.y][head.x]=0;let qi=0;
    while(qi<q.length){let p=q[qi++];let d=dist[p.y][p.x];
      for(let n of[{x:p.x+1,y:p.y},{x:p.x-1,y:p.y},{x:p.x,y:p.y+1},{x:p.x,y:p.y-1}]){
        if(n.x<0||n.x>=GRID||n.y<0||n.y>=GRID)continue;
        if(occupied.has(n.x+","+n.y)&&!(n.x===snake[snake.length-1].x&&n.y===snake[snake.length-1].y))continue;
        if(dist[n.y][n.x]!==-1)continue;
        dist[n.y][n.x]=d+1;q.push(n);
      }
    }
    let best=[],val=diffSel.value==="far"?-1:1e9;
    for(let e of empties){let d=dist[e.y][e.x];if(d===-1)continue;
      if(diffSel.value==="far"){if(d>val){val=d;best=[e];}else if(d===val)best.push(e);}
      else{if(d<val){val=d;best=[e];}else if(d===val)best.push(e);}
    }
    if(best.length){food=best[Math.floor(Math.random()*best.length)];aiNote.textContent=`AI placed food (${diffSel.value}, dist=${val})`;}
    else{food=empties[Math.floor(Math.random()*empties.length)];aiNote.textContent="AI fallback random.";}
  }
  window.setDir=(x,y)=>{nextDir={x,y};};
  init();
})();
</script>
</body>
</html>
